<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Spanish DGT Vocabulary Flashcards</title>
    <link rel="stylesheet" href="styles.css" />
    <!-- Add this script to detect page type before loading any other scripts -->
    <script>
      window.isVocabManagerPage = false;
    </script>
  </head>
  <body>
    <div class="app-container">
      <div class="header">
        <h1>Spanish DGT <a href="vocabulary-manager.html">Vocabulary</a></h1>
        <div class="subtitle">
          Interactive Flashcards for Spanish Driving Exam
        </div>

        <div class="mode-selector">
          <button class="mode-btn active" onclick="setMode('flashcard', event)">
            Flashcards
          </button>
          <button class="mode-btn" onclick="setMode('quiz', event)">
            Quiz Mode
          </button>
        </div>

        <div class="controls">
          <div class="category-buttons" id="categoryButtons">
            <!-- Category buttons will be populated dynamically -->
          </div>
        </div>

        <div class="stats">
          <div class="stat">
            <div class="stat-number">
              <span id="currentCard">0</span> of <span id="totalCards">0</span>
            </div>
            <div>Cards</div>
            <div class="stat-category" id="categoryInfo"></div>
          </div>
          <div class="stat">
            <div class="stat-number" id="knownCards">0</div>
            <div>Known</div>
          </div>
          <div class="stat">
            <div class="stat-number" id="unknownCards">0</div>
            <div>Unknown</div>
          </div>
        </div>

        <div class="controls-buttons-row">
          <div class="toggle-container">
            <span class="toggle-label left" onclick="toggleShowAllCards()"
              >Unknown Only</span
            >
            <button
              class="toggle-switch"
              id="showAllToggle"
              onclick="toggleShowAllCards()"
            ></button>
            <span class="toggle-label right" onclick="toggleShowAllCards()"
              >All Cards</span
            >
          </div>
          <button onclick="resetProgress()">Reset Progress</button>
        </div>

        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
      </div>

      <!-- Flashcard Mode -->
      <div id="flashcardMode">
        <div class="flashcard-container">
          <div class="flashcard" id="flashcard" onclick="flipCard()">
            <div class="card-face card-front">
              <div class="spanish-word" id="spanishWord">Click to start</div>
              <div class="category-badge" id="category">Category</div>
            </div>
            <div class="card-face card-back">
              <div class="translation" id="translation">Translation</div>
              <div class="example" id="example">Example sentence</div>
            </div>
          </div>
        </div>

        <div class="card-actions">
          <button class="action-btn dont-know-btn" onclick="markCard(false)">
            Don't Know
          </button>
          <button class="action-btn know-btn" onclick="markCard(true)">
            I Know This
          </button>
        </div>
      </div>

      <!-- Quiz Mode -->
      <div id="quizMode" class="hidden">
        <div class="quiz-mode">
          <div class="quiz-question" id="quizQuestion">
            What does "veh√≠culo" mean?
          </div>
          <div class="quiz-options" id="quizOptions">
            <!-- Options will be populated dynamically -->
            <div class="quiz-option-placeholder">
              Click a mode button above to start...
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="vocabulary.js"></script>
    <script src="icons.js"></script>
    <script src="core.js"></script>
    <script src="flashcard-mode.js"></script>
    <script src="quiz-mode.js"></script>
    <script src="category-manager.js"></script>
    <script src="stats-manager.js"></script>
    <script src="ui-helpers.js"></script>
    <script src="script.js"></script>
    <script>
      // This script will run after both vocabulary.js and script.js have loaded
      document.addEventListener("DOMContentLoaded", function () {
        console.log("Index page DOM loaded");
        // Initialization is already handled in script.js
        // Just log that we're on the index page
        if (window.vocabApp) {
          console.log("vocabApp is available on index page");
        }
      });
    </script>

    <footer class="site-footer">
      <div class="footer-content">
        <span id="footer-last-update">Last update: ...</span>
        <span class="footer-divider">&nbsp;|&nbsp;</span>
        <span id="footer-word-count">Vocabulary: ... words</span>
        <span class="footer-divider">&nbsp;|&nbsp;</span>
        <a
          href="https://github.com/anton-g-kulikov/dgt-vocab"
          target="_blank"
          rel="noopener"
          >Contribute on GitHub</a
        >
        <span class="footer-divider">&nbsp;|&nbsp;</span>
        <a
          href="https://buymeacoffee.com/antonkulikov"
          target="_blank"
          rel="noopener"
          >Find this useful? Buy me a coffee :)
        >
      </div>
    </footer>
    <script>
      // Populate footer info
      document.addEventListener("DOMContentLoaded", function () {
        // Last update: use the build date or fallback to today
        var lastUpdate = "2024-06-02"; // <-- Update this manually
        document.getElementById("footer-last-update").textContent =
          "Last update: " + lastUpdate;

        // Word count: reuse the totalCards value that's already being calculated
        function updateWordCount() {
          // Try to get the total count from the existing totalCards element
          const totalCardsElement = document.getElementById("totalCards");
          if (totalCardsElement && totalCardsElement.textContent) {
            const wordCount = totalCardsElement.textContent;
            document.getElementById("footer-word-count").textContent =
              "Vocabulary: " + wordCount + " words";
            return true;
          }
          return false;
        }

        // Try immediately
        if (!updateWordCount()) {
          // If not loaded yet, wait a bit and try again
          const checkInterval = setInterval(function () {
            if (updateWordCount() || window.vocabApp) {
              clearInterval(checkInterval);

              // If vocabApp exists but totalCards not filled in yet
              if (window.vocabApp && window.vocabApp.allCards) {
                document.getElementById("footer-word-count").textContent =
                  "Vocabulary: " + window.vocabApp.allCards.length + " words";
              }
            }
          }, 100);

          // Stop checking after 5 seconds
          setTimeout(function () {
            clearInterval(checkInterval);
          }, 5000);
        }
      });
    </script>
  </body>
</html>
